import{j as e}from"./vendor-query-D8MH73Ff.js";import{r as y}from"./vendor-react-F9Y4d3HK.js";import{a as C}from"./vendor-utils-C5RVuWu4.js";import{c as z,m as D,ah as R,a2 as _,a3 as V,F as E,ag as q,a8 as U,a7 as O,ai as v,S as Q,ad as P,aj as Y,ak as $,af as w,B as K,a as T,al as Z,a9 as I,M as J,U as X,am as H}from"./main-DKP_aL3o.js";import{H as ee}from"./heart-D9XfMmEo.js";import{B as se}from"./briefcase-BLDI7x1j.js";import{G as te}from"./graduation-cap-DG9DgvaR.js";import{C as ae}from"./car-CbfqpdFW.js";import{S as W}from"./shield-BdLXXyqf.js";import{A}from"./alert-circle-UfXG2lJa.js";import{L as S}from"./loader-2-3ubLXRWD.js";import{D as ie}from"./dollar-sign-BToiA5fF.js";import{E as re}from"./external-link-Cc2dZ5ix.js";import{S as ne}from"./send-DTZE80UV.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=z("PawPrint",[["circle",{cx:"11",cy:"4",r:"2",key:"vol9p0"}],["circle",{cx:"18",cy:"8",r:"2",key:"17gozi"}],["circle",{cx:"20",cy:"16",r:"2",key:"1v9bxh"}],["path",{d:"M9 10a5 5 0 0 1 5 5v3.5a3.5 3.5 0 0 1-6.84 1.045Q6.52 17.48 4.46 16.84A3.5 3.5 0 0 1 5.5 10Z",key:"1ydw1z"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=z("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),L=[{id:"visa-application",title:"Complete Visa Application Guide",description:"Step-by-step walkthrough of the French visa application process, from choosing the right visa type to attending your appointment.",category:"Visa & Immigration",readTime:"25 min",difficulty:"beginner",featured:!0,icon:E,sections:["Choosing the right visa type","Required documents checklist","Filling out the application form","Booking your appointment","What to expect at the consulate","After approval: next steps"]},{id:"housing-france",title:"Finding Housing in France",description:"Navigate the French rental market with confidence. Learn about dossier requirements, guarantor options, and tenant rights.",category:"Housing",readTime:"20 min",difficulty:"intermediate",featured:!0,icon:q,sections:["Understanding the rental market","Building your dossier locatif","Guarantor options (Visale, GLI)","Viewing apartments","Signing your lease","Tenant rights and responsibilities"]},{id:"banking-finance",title:"Banking & Finance Setup",description:"Open a French bank account, understand the banking system, and manage your finances as an expat.",category:"Finance",readTime:"15 min",difficulty:"beginner",icon:U,sections:["Choosing a bank (traditional vs online)","Documents needed to open an account","Understanding French banking fees","Setting up automatic payments","International transfers","Tax considerations"]},{id:"healthcare-system",title:"French Healthcare System",description:"Understand how French healthcare works, register with CPAM, and choose complementary health insurance (mutuelle).",category:"Healthcare",readTime:"18 min",difficulty:"intermediate",featured:!0,icon:ee,sections:["How French healthcare works","Registering with CPAM","Getting your Carte Vitale","Choosing a mutuelle","Finding doctors and specialists","Pharmacy system"]},{id:"working-france",title:"Working in France",description:"Employment contracts, workplace culture, employee rights, and setting up as a freelancer or entrepreneur.",category:"Employment",readTime:"22 min",difficulty:"intermediate",icon:se,sections:["Types of employment contracts","Understanding your payslip","Employee rights and benefits","Setting up as auto-entrepreneur","Workplace culture tips","Networking and job hunting"]},{id:"education-schools",title:"Education & Schools",description:"Navigate the French education system for your children, from maternelle to university options.",category:"Education",readTime:"16 min",difficulty:"beginner",icon:te,sections:["French education system overview","Public vs private schools","International schools","Enrolling your child","After-school activities","Higher education options"]},{id:"driving-transport",title:"Driving & Transportation",description:"Exchange your driving license, understand French driving rules, and navigate public transportation.",category:"Transportation",readTime:"14 min",difficulty:"beginner",icon:ae,sections:["Exchanging your driving license","Buying or leasing a car","Car insurance requirements","Public transportation options","Getting a Navigo pass","French driving rules"]},{id:"social-security",title:"Social Security & Benefits",description:"Register for French social security, understand your contributions, and access family benefits.",category:"Administration",readTime:"20 min",difficulty:"advanced",icon:W,sections:["Social security system overview","Registration process","Understanding contributions","Family benefits (CAF)","Retirement system","Unemployment benefits"]},{id:"family-relocation",title:"Relocating with Family",description:"Special considerations when moving to France with spouse and children, including visa requirements and settling in.",category:"Family",readTime:"18 min",difficulty:"intermediate",icon:O,sections:["Family visa requirements","Spouse work authorization","Childcare options","Family healthcare coverage","Activities and integration","Support networks"]}],ce=[{id:"all",label:"All Guides"},{id:"Visa & Immigration",label:"Visa & Immigration"},{id:"Housing",label:"Housing"},{id:"Finance",label:"Finance"},{id:"Healthcare",label:"Healthcare"},{id:"Employment",label:"Employment"},{id:"Education",label:"Education"},{id:"Transportation",label:"Transportation"},{id:"Administration",label:"Administration"},{id:"Family",label:"Family"}],B={beginner:"bg-green-100 text-green-700",intermediate:"bg-yellow-100 text-yellow-700",advanced:"bg-red-100 text-red-700"};function Pe(){const[t,o]=y.useState(""),[a,x]=y.useState("all"),[h,p]=y.useState(null),[l,u]=y.useState(null),{setActiveView:i}=D(),{data:r,isLoading:n}=R(),{data:c}=_(),{data:f}=V(),d=L.filter(s=>{const g=t===""||s.title.toLowerCase().includes(t.toLowerCase())||s.description.toLowerCase().includes(t.toLowerCase()),k=a==="all"||s.category===a;return g&&k}),m=L.filter(s=>s.featured),b=(()=>{if(!c)return[];const s=[];return c.visa_type&&c.visa_type!=="undecided"&&s.push({type:"visa-application",title:"Your Visa Application Guide",description:`Personalized guide for your ${c.visa_type} visa application`,icon:E}),(c.birth_state||c.spouse_birth_state||c.marriage_state)&&s.push({type:"apostille",title:"Your Apostille Guide",description:"State-specific apostille information for your documents",icon:W}),c.has_pets&&c.has_pets!=="no"&&s.push({type:"pet-relocation",title:"Your Pet Relocation Guide",description:`Personalized guide for relocating with ${c.has_pets}`,icon:le}),s})();return l?e.jsx(ue,{guideType:l,onBack:()=>u(null)}):h?e.jsx(xe,{guide:h,onBack:()=>p(null)}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Relocation Guides"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive guides to help you navigate every aspect of moving to France"})]}),b.length>0&&t===""&&a==="all"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-purple-600"}),"Personalized for You"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:b.map(s=>e.jsx(oe,{guide:s,onClick:()=>u(s.type)},s.type))})]}),f&&f.percentage<50&&t===""&&a==="all"&&e.jsx("div",{className:"mb-8 card p-4 bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-1",children:"Complete your profile for personalized guides"}),e.jsxs("p",{className:"text-sm text-blue-700 mb-3",children:["Fill out your profile to get customized guides based on your visa type, location, and personal circumstances. Your profile is currently ",f.percentage,"% complete."]}),e.jsx("button",{onClick:()=>i("settings"),className:"text-sm font-medium text-blue-600 hover:text-blue-700 underline",children:"Complete your profile"})]})]})}),e.jsx("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search guides...",value:t,onChange:s=>o(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),e.jsx("div",{className:"mb-8 flex flex-wrap gap-2",children:ce.map(s=>e.jsx("button",{onClick:()=>x(s.id),className:C("px-4 py-2 rounded-full text-sm font-medium transition-colors",a===s.id?"bg-primary-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:s.label},s.id))}),t===""&&a==="all"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-yellow-500"}),"Featured Guides"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map(s=>e.jsx(me,{guide:s,onClick:()=>p(s)},s.id))})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-primary-600"}),a==="all"?"All Guides":a,e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",d.length,")"]})]}),d.length===0?e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(P,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No guides found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(s=>e.jsx(de,{guide:s,onClick:()=>p(s)},s.id))})]})]})}function oe({guide:t,onClick:o}){const a=t.icon;return e.jsxs("button",{onClick:o,className:"card p-6 text-left bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:e.jsx(a,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("span",{className:"px-2 py-1 bg-purple-600 text-white text-xs font-medium rounded-full flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"}),"Personalized"]})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 group-hover:text-purple-700 transition-colors",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"Based on your profile"}),e.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-purple-600 group-hover:gap-2 transition-all",children:["View guide",e.jsx(H,{className:"w-4 h-4"})]})]})]})}function de({guide:t,onClick:o}){const a=t.icon;return e.jsx("button",{onClick:o,className:"card p-5 text-left hover:shadow-md transition-shadow group",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary-50 rounded-lg group-hover:bg-primary-100 transition-colors",children:e.jsx(a,{className:"w-6 h-6 text-primary-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1 group-hover:text-primary-600 transition-colors",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-3",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx(T,{className:"w-3 h-3"}),t.readTime]}),e.jsx("span",{className:C("px-2 py-0.5 rounded-full",B[t.difficulty]),children:t.difficulty})]})]}),e.jsx(w,{className:"w-5 h-5 text-gray-400 group-hover:text-primary-600 transition-colors"})]})})}function me({guide:t,onClick:o}){const a=t.icon;return e.jsxs("button",{onClick:o,className:"card p-6 text-left bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200 hover:shadow-md transition-shadow group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:e.jsx(a,{className:"w-5 h-5 text-primary-600"})}),e.jsx("span",{className:"text-xs font-medium text-primary-600",children:t.category})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 group-hover:text-primary-700 transition-colors",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(T,{className:"w-3 h-3"}),t.readTime]}),e.jsxs("span",{className:"flex items-center gap-1 text-sm font-medium text-primary-600 group-hover:gap-2 transition-all",children:["Read guide",e.jsx(H,{className:"w-4 h-4"})]})]})]})}function xe({guide:t,onBack:o}){const a=t.icon,[x,h]=y.useState([]),[p,l]=y.useState(""),[u,i]=y.useState(null),[r,n]=y.useState(!1),c=y.useRef(null),f=y.useRef(null),d=Z();y.useEffect(()=>{x.length>0&&!r&&c.current&&setTimeout(()=>{var s;(s=c.current)==null||s.scrollIntoView({behavior:"smooth",block:"start"})},100)},[x,r]);const m=pe(t.id),j=async s=>{const g=s||p.trim();if(!g||d.isPending)return;const k={id:Date.now().toString(),role:"user",content:g,timestamp:new Date().toISOString()};h(N=>[...N,k]),l(""),n(!0);try{const N=await d.mutateAsync({message:g,context:t.id,include_practice:!0});if(N.success&&N.message){const F={id:(Date.now()+1).toString(),role:"assistant",content:N.message,timestamp:new Date().toISOString(),sources:N.sources};h(G=>[...G,F])}}catch{const F={id:(Date.now()+1).toString(),role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date().toISOString()};h(G=>[...G,F])}finally{n(!1)}},b=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),j())};return e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"}),"Back to guides"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[calc(100vh-12rem)]",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6 overflow-y-auto",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary-50 rounded-xl",children:e.jsx(a,{className:"w-6 h-6 text-primary-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-primary-600",children:t.category}),e.jsx("span",{className:C("px-2 py-0.5 rounded-full text-xs",B[t.difficulty]),children:t.difficulty})]}),e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]})]})}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Guide Sections"}),e.jsx("div",{className:"space-y-1",children:t.sections.map((s,g)=>e.jsxs("button",{onClick:()=>{i(g),j(`Tell me about "${s}" for ${t.title.toLowerCase()}`)},className:C("w-full flex items-center gap-3 p-3 rounded-lg text-left transition-colors",u===g?"bg-primary-50 text-primary-700":"hover:bg-gray-50 text-gray-700"),children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-primary-100 text-primary-600 flex items-center justify-center text-xs font-medium flex-shrink-0",children:g+1}),e.jsx("span",{className:"text-sm",children:s})]},g))})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-yellow-500"}),"Quick Questions"]}),e.jsx("div",{className:"space-y-2",children:m.map((s,g)=>e.jsx("button",{onClick:()=>j(s),className:"w-full text-left text-sm text-gray-600 hover:text-primary-600 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:s},g))})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card h-full flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center",children:e.jsx(I,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"AI Guide Assistant"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Ask questions about ",t.title.toLowerCase()]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:x.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary-50 flex items-center justify-center mb-4",children:e.jsx(J,{className:"w-8 h-8 text-primary-600"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Start a conversation"}),e.jsx("p",{className:"text-sm text-gray-600 max-w-sm mb-4",children:"Click on a section from the guide, ask a quick question, or type your own question below."}),e.jsx("p",{className:"text-xs text-gray-500",children:"I can help you understand requirements, timelines, and next steps."})]}):e.jsxs("div",{className:"space-y-4",children:[x.map((s,g)=>{const k=s.role==="assistant"&&g===x.length-1;return s.role==="user"?e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("div",{className:"max-w-[80%] rounded-2xl rounded-tr-sm px-4 py-3 bg-primary-600 text-white",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content})}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 flex items-center justify-center flex-shrink-0",children:e.jsx(X,{className:"w-4 h-4 text-white"})})]},s.id):e.jsxs("div",{ref:k?c:void 0,className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center flex-shrink-0",children:e.jsx(I,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"flex-1 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"px-5 py-4",children:e.jsx(he,{content:s.content})})})]},s.id)}),r&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center flex-shrink-0",children:e.jsx(I,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"bg-gray-100 rounded-2xl rounded-tl-sm px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 animate-spin text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Thinking..."})]})})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("textarea",{ref:f,value:p,onChange:s=>l(s.target.value),onKeyPress:b,placeholder:"Ask a question about this guide...",rows:1,className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm",disabled:d.isPending}),e.jsx("button",{onClick:()=>j(),disabled:!p.trim()||d.isPending,className:C("px-4 py-3 rounded-xl transition-colors flex items-center justify-center",p.trim()&&!d.isPending?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:e.jsx(ne,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Press Enter to send • Shift+Enter for new line"})]})]})})]})]})}function he({content:t}){const o=t.split(`
`),a=[];let x=[],h=null;const p=u=>{const i=[];let r=u,n=0;for(;r.length>0;){const c=r.match(/\[([^\]]+)\]\(([^)]+)\)/),f=r.match(/\*\*([^*]+)\*\*/),d=[c?{type:"link",match:c,index:r.indexOf(c[0])}:null,f?{type:"bold",match:f,index:r.indexOf(f[0])}:null].filter(Boolean).sort((j,b)=>((j==null?void 0:j.index)??1/0)-((b==null?void 0:b.index)??1/0));if(d.length===0||d[0]===null){i.push(r);break}const m=d[0];m.index>0&&i.push(r.slice(0,m.index)),m.type==="link"&&m.match?(i.push(e.jsx("a",{href:m.match[2],target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700 underline font-medium",children:m.match[1]},n++)),r=r.slice(m.index+m.match[0].length)):m.type==="bold"&&m.match&&(i.push(e.jsx("strong",{className:"font-semibold text-gray-900",children:m.match[1]},n++)),r=r.slice(m.index+m.match[0].length))}return e.jsx(e.Fragment,{children:i})},l=()=>{if(x.length>0){const u=h==="ol";a.push(u?e.jsx("ol",{className:"my-3 ml-5 space-y-1.5 list-decimal text-sm",children:x.map((i,r)=>e.jsx("li",{className:"text-gray-700 leading-relaxed pl-1",children:i.formatted},r))},a.length):e.jsx("ul",{className:"my-3 ml-5 space-y-1.5 text-sm",children:x.map((i,r)=>e.jsxs("li",{className:"text-gray-700 leading-relaxed flex items-start gap-2",children:[e.jsx("span",{className:"text-primary-500 mt-0.5",children:"•"}),e.jsx("span",{children:i.formatted})]},r))},a.length)),x=[],h=null}};return o.forEach(u=>{const i=u.trim();if(i.startsWith("## "))l(),a.push(e.jsx("h3",{className:"text-base font-semibold text-gray-900 mt-4 mb-2 pb-1 border-b border-gray-100",children:p(i.slice(3))},a.length));else if(i.startsWith("### "))l(),a.push(e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mt-3 mb-1.5",children:p(i.slice(4))},a.length));else if(i.startsWith("**")&&i.endsWith("**")&&!i.slice(2,-2).includes("**"))l(),a.push(e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mt-3 mb-1.5",children:i.slice(2,-2)},a.length));else if(i.match(/^[\-\*•]\s/)){h!=="ul"&&l(),h="ul";const r=i.replace(/^[\-\*•]\s/,"");x.push({text:r,formatted:p(r)})}else if(i.match(/^\d+\.\s/)){h!=="ol"&&l(),h="ol";const r=i.replace(/^\d+\.\s/,"");x.push({text:r,formatted:p(r)})}else i?(l(),a.push(e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed mb-2",children:p(i)},a.length))):l()}),l(),e.jsx("div",{className:"guide-message-content",children:a})}function pe(t){return{"visa-application":["What documents do I need for my visa application?","How long does the visa process take?","What are the financial requirements?","Can I work while my visa is being processed?"],housing:["What documents do renters need in France?","How do I find a guarantor (garant)?","What is a dossier de location?","Should I buy or rent when first arriving?"],healthcare:["How do I register for the French healthcare system?","What is a Carte Vitale and how do I get one?","Do I need private health insurance?","How do I find an English-speaking doctor?"],banking:["Which French bank should I choose?","What documents do I need to open an account?","Can I open an account before moving?","How do transfers from the US work?"],taxes:["When do I become a French tax resident?","How does the US-France tax treaty work?","Do I need to file taxes in both countries?","What deductions can I claim?"],driving:["Can I drive with my US license in France?","How do I exchange my license?","Do I need an international driving permit?","What are the rules for buying a car?"]}[t]||["What are the first steps I should take?","What documents will I need?","How long does this process typically take?","What are common mistakes to avoid?"]}function ue({guideType:t,onBack:o}){var i,r;const{data:a,isLoading:x,error:h}=Y(t),{data:p}=_(),l=$(),u=()=>{l.mutate(t)};return x?e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"}),"Back to guides"]}),e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(S,{className:"w-8 h-8 text-primary-600 animate-spin"})})]}):h?e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"}),"Back to guides"]}),e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(A,{className:"w-12 h-12 text-red-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to load guide"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"We could not load your personalized guide. Please try again."}),e.jsx("button",{onClick:u,disabled:l.isPending,className:"btn-primary",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4"}),"Generate AI Guide"]})})]})]}):a?e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"}),"Back to guides"]}),e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("div",{className:"card p-6 mb-6 bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"p-4 bg-white rounded-xl shadow-sm",children:e.jsx(v,{className:"w-8 h-8 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-purple-600 text-white text-xs font-medium rounded-full",children:"Personalized"}),((i=a.metadata)==null?void 0:i.last_updated)&&e.jsxs("span",{className:"text-xs text-purple-600",children:["Updated ",new Date(a.metadata.last_updated).toLocaleDateString()]})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.title}),e.jsx("p",{className:"text-gray-700",children:a.description})]})]}),!a.is_personalized&&e.jsx("button",{onClick:u,disabled:l.isPending,className:"btn-primary whitespace-nowrap",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4"}),"Regenerate"]})})]})}),t==="apostille"&&((r=a.metadata)==null?void 0:r.states)&&a.metadata.states.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your State-Specific Information"}),e.jsx("div",{className:"space-y-4",children:a.metadata.states.map(n=>e.jsxs("div",{className:"card p-5",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(K,{className:"w-4 h-4 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:n.state_name})]}),e.jsx("p",{className:"text-sm text-gray-600",children:n.document})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Agency"}),e.jsx("p",{className:"text-sm text-gray-900",children:n.agency})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Method"}),e.jsx("p",{className:"text-sm text-gray-900",children:n.method})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Cost"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3 text-green-600"}),e.jsx("p",{className:"text-sm text-gray-900",children:n.cost})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-1",children:"Processing Time"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3 text-blue-600"}),e.jsx("p",{className:"text-sm text-gray-900",children:n.processing_time})]})]})]}),n.website&&e.jsxs("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-primary-600 hover:text-primary-700 font-medium",children:["Visit agency website",e.jsx(re,{className:"w-3 h-3"})]}),n.notes&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-800",children:n.notes})})]},n.state))})]}),a.sections&&a.sections.length>0&&e.jsx("div",{className:"space-y-6",children:a.sections.map((n,c)=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-sm font-semibold flex-shrink-0",children:c+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:n.title}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:n.content}}),n.tips&&n.tips.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-medium text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Tips"]}),e.jsx("ul",{className:"space-y-1",children:n.tips.map((f,d)=>e.jsx("li",{className:"text-sm text-blue-800",children:f},d))})]}),n.warnings&&n.warnings.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("h4",{className:"text-sm font-medium text-yellow-900 mb-2 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Important Notes"]}),e.jsx("ul",{className:"space-y-1",children:n.warnings.map((f,d)=>e.jsx("li",{className:"text-sm text-yellow-800",children:f},d))})]})]})]})},n.id))})]})]}):e.jsxs("div",{className:"p-6",children:[e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"}),"Back to guides"]}),e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx(P,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Guide not available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"This personalized guide has not been generated yet."}),e.jsx("button",{onClick:u,disabled:l.isPending,className:"btn-primary",children:l.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-4 h-4"}),"Generate AI Guide"]})})]})]})}export{Pe as default};
